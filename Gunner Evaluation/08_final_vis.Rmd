---
title: "8. Visualizing Combined Results"
output:
  html_document:
    df_print: paged
---
## 8.1 Imports
```{r message=FALSE, warning=FALSE}
source("E:/R Projects/gunner_evaluation/R/00_source.R")

library(tidyverse)
library(ggimage)
library(ggrepel)

gunnerExYds <- read.csv(paste0(wd$data, 'gunner_stats_exYds.csv'), 
                        na.strings = c('NA', NA, '', ' '))

gunnerFCL <- read.csv(paste0(wd$data, 'gunner_stats_FCP.csv'), 
                      na.strings = c('NA', NA, '', ' '))

# join dataframes
gunnerStats <- cbind(gunnerExYds, FCP = gunnerFCL$FCP)
```

## 8.2 Inverse Fair Catch Probability
To make the chart easier to read, I am going to plot the inverse of the probability of causing a fair catch, which is the probability of allowing a return. This way both statistics can be read the same way (lower number is good, higher number is bad)  
```{r}
gunnerStats$returnProb <- (1 - gunnerStats$FCP)
```

## 8.3 Visualization
Combining these two measurements, some of the best gunners between the 2018-2020 seasons were Justin Bethel, Mack Hollins, Tavierre Thomas, and Matthew Slater.
```{r fig.height=6, fig.width=9.7082}
ggplot() +
  geom_point(data = gunnerStats, aes(x = returnProb, y = exReturnYds)) +
  geom_vline(xintercept = mean(gunnerStats$returnProb), color = 'red', alpha = 0.7, linetype = 'dashed') +
  geom_hline(yintercept = mean(gunnerStats$exReturnYds), color = 'red', alpha = 0.7, linetype = 'dashed') +
  annotate('text', x = 0.41, y = 8.5, label = 'Good Before Catch, Bad After Catch') +
  annotate('text', x = 0.41, y = 4, label = 'Good Before Catch, Good After Catch') +
  annotate('text', x = 0.6625, y = 8.5, label = 'Bad Before Catch, Bad After Catch') +
  annotate('text', x = 0.6625, y = 4, label = 'Bad Before Catch, Good After Catch') +
  geom_label_repel(data = gunnerStats, aes(x = returnProb, y = exReturnYds, label = gunnerName)) +
  labs(title = 'Overall Gunner Performance', subtitle = 'Must Have Played in at Least 30 Plays') +
  xlab('Probability of Allowing Return') +
  ylab('Expected Return Yards')
```

## 8.4 Save Plot
```{r}
ggsave(paste0(wd$output, 'final_vis.png'), width = 9.7082, height = 6)
```

